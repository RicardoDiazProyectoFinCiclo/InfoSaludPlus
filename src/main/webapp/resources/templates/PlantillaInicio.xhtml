<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      >-->
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" 
      xmlns:a4j="http://richfaces.org/a4j" 
      xmlns:rich="http://richfaces.org/rich"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <f:view>
        <h:head>
            <title>Info Salud Plus</title>
            <h:outputStylesheet library="css" name="bootstrap.min.css"/>
            <h:outputStylesheet library="css" name="estilo.css"  />
            <h:outputScript library="js" name="jquery-3.1.1.min.js"/>
            <h:outputScript library="js" name="bootstrap.min.js"/>
        </h:head>
        <h:body>
            <header class="row">
                <div id="logo" class="col-sm-3">
                    <h:graphicImage library="images" class="img-rounded" name="logoInfoSaludPlus.png"/>

                </div>
                <div class="col-sm-offset-1 col-sm-8">
                    <h1>Portal web de Info Salud Plus</h1>
                </div>
            </header>
            <nav>
                <h:outputStylesheet>
                    .pic {
                    margin-bottom: -4px;
                    margin-right: 2px;
                    }

                    .search .rf-ddm-itm-sel {
                    background-color: transparent;
                    background-image:none;
                    border-color: transparent;
                    cursor: default;
                    }
                </h:outputStylesheet>

                <h:form id="form">
                    <rich:toolbar height="26px" id="menuPrincipal">
                        <rich:dropDownMenu mode="ajax">
                            <f:facet name="label">
                                <h:panelGrid cellpadding="0" cellspacing="0" columns="2" style="vertical-align:middle">
                                    <h:outputText value="Servicios" styleClass="menuItemLb"/>
                                </h:panelGrid>
                            </f:facet>
                            <rich:menuItem mode="client">
                                <h:outputText value="Cardiología" />
                            </rich:menuItem>
                            <rich:menuItem mode="client">
                                <h:outputText value="Neumología" />
                            </rich:menuItem>
                            <rich:menuItem mode="client">
                                <h:outputText value="Traumatología" />
                            </rich:menuItem>
                            <rich:menuItem mode="client">
                                <h:outputText value="Medicina General" />
                            </rich:menuItem>
                            <rich:menuItem mode="client">
                                <h:outputText value="Medicina Interna" />
                            </rich:menuItem>
                        </rich:dropDownMenu>

                        <rich:toolbarGroup location="right">
                            <c:if test="#{sessionScope.usuario == null}">
                                <rich:menuItem  onclick="return false;">
                                    <h:commandLink value="Login" styleClass="menuItemLb">
                                        <rich:componentControl target="login" event="click" operation="show" />
                                    </h:commandLink>
                                </rich:menuItem>
                                <rich:menuItem onclick="return false;">
                                    <h:commandLink value="Registro" styleClass="menuItemLb">
                                        <rich:componentControl target="registro" event="click" operation="show" />
                                    </h:commandLink>
                                </rich:menuItem>
                            </c:if>
                            <c:if test="#{sessionScope.usuario != null}">
                                <rich:menuItem mode="client">
                                    <h:outputText styleClass="menuItemLb" value="Bienvenido, #{sessionScope.usuario.nombre} #{sessionScope.usuario.numSegSoc}"/>
                                </rich:menuItem>

                                <rich:menuItem label="Panel de control" styleClass="menuItemLb" />
                                <rich:menuItem label="Cerrar sesión" action="#{usuario.cerrarSesion()}" styleClass="menuItemLb"/>
                            </c:if>
                        </rich:toolbarGroup>
                    </rich:toolbar>
                </h:form>

                <br />
                <a4j:outputPanel ajaxRendered="true">
                    <h:outputText value="Inicio" style="font-weight:bold" />
                </a4j:outputPanel>
                <br />
            </nav>
            <div id="secciones" class="row">
                <ui:insert name="secciones">

                </ui:insert>
            </div>

            <footer>

                <rich:popupPanel id="registro" modal="true" resizeable="false" autosized="true" width="500">
                    <f:facet name="header">
                        <h:outputText value="Regístrate" style="font-size: 14pt; font-weight: bold; text-align: center;" />
                    </f:facet>
                    <f:facet name="controls">
                        <h:outputLink value="#" onclick="#{rich:component('registro')}.hide(); return false;" style="color: inherit">
                            X
                        </h:outputLink>
                    </f:facet>
                    <h:form id="formularioRegistro">
                        <rich:graphValidator value="#{usuario}" id="gv">
                            <rich:panel>
                                <rich:messages for="gv" />
                                <rich:messages globalOnly="true" />

                                <h:panelGrid columns="1" width="80%" styleClass="panel">

                                    <h:outputLabel value="Nombre " for="nombre"/>
                                    <h:panelGroup>
                                        <t:inputText id="nombre" size="50" value="#{paciente.nombre}">
                                            <f:validateLength maximum="40" minimum="3"/>
                                        </t:inputText>
                                        <rich:message for="nombre"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Apellidos " for="apellidos" /> 
                                    <h:panelGroup>
                                        <h:inputText id="apellidos" size="50" value="#{paciente.apellidos}" maxlength="5" />
                                        <rich:message for="apellidos"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="NIF/DNI " for="dni"/> 
                                    <h:panelGroup>
                                        <h:inputText id="dni" size="9" value="#{paciente.nif}" maxlength="9"/>
                                        <rich:message for="dni"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Número Seguridad Social " for="numSegSoc"/> 
                                    <h:panelGroup>
                                        <h:inputText id="numSegSoc" size="30" value="#{paciente.numSegSoc}" maxlength="20" />
                                        <rich:message for="numSegSoc"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Email "  for="email"/> 
                                    <h:panelGroup>
                                        <h:inputText id="email" size="50" value="#{paciente.email}" pt:placeholder="usuario@gmail.com"> 
                                            <t:validateEmail/>
                                        </h:inputText>
                                        <h:message for="email"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Fecha de nacimiento: " for="fechaNac" /> 
                                    <h:panelGroup>
                                        <rich:calendar id="fechaNac" value="#{paciente.fechaNacimiento}" />
                                        <rich:message for="fechaNac"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Contraseña: "  for="clave"/> 
                                    <h:panelGroup>
                                        <h:inputSecret id="clave" size="30" value="#{paciente.clave}"/>
                                        <rich:message for="clave"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Repetir contraseña: " for="claveRep"/>
                                    <h:panelGroup>
                                        <h:inputSecret id="claveRep" size="30" value="#{paciente.claveRep}"/>
                                        <rich:message for="claveRep"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                                <a4j:commandButton value="Registrarse" render="formularioRegistro menuPrincipal" action="#{paciente.registro()}" />
                                <a4j:commandButton type="reset" value="Limpiar"/>
                            </rich:panel>
                        </rich:graphValidator>
                    </h:form>

                </rich:popupPanel>

                <rich:popupPanel id="login" modal="true" resizeable="false" autosized="true" onmaskclick="#{rich:component('login')}.hide()" width="350" height="200">
                    <f:facet name="header">
                        <h:outputText value="Panel de login" />
                    </f:facet>
                    <f:facet name="controls">
                        <h:outputLink value="#" onclick="#{rich:component('login')}.hide(); return false;" style="color: inherit">
                            X
                        </h:outputLink>
                    </f:facet>
                    <h:form id="formularioLogin">
                        <rich:validator event="change">
                            <rich:panel>
                                <h:panelGrid columns="2">

                                    <f:facet name="header">
                                        <h4 class="text-center bg-danger"><h:outputText value="#{usuario.mensaje}"/></h4>
                                    </f:facet>

                                    <h:outputLabel value="Email: " for="email"/>
                                    <h:inputText id="email" value="#{paciente.email}" pt:placeholder="usuario@gmail.com"> 
                                        <t:validateEmail/>
                                    </h:inputText>
                                    <h:outputLabel value="Contraseña: " for="clave"/> <h:inputSecret id="clave" value="#{usuario.clave}"/>

                                    <rich:notifyMessages stayTime="2000" nonblocking="true" />
                                    <f:facet name="footer" class="center-block text-center" >
                                        <a4j:commandButton value="Login" render="login menuPrincipal" action="#{usuario.login()}" execute="@form" >
                                            <rich:componentControl target="login" event="blur" operation="hide" />
                                        </a4j:commandButton>
                                        <a4j:commandButton type="reset" value="Limpiar"/>

                                    </f:facet>
                                </h:panelGrid>
                            </rich:panel>
                        </rich:validator>
                    </h:form>

                </rich:popupPanel>


                <c:if test="#{usuario.mensaje != null}">

                    <script>
                        #{rich:component('login')}.show();
                    </script>
                </c:if>
                <p>Creado por Ricardo Díaz © 2017</p>
                <p>Esto es una maqueta, puede tener ligeras variaciones con respecto al resultado final.</p>
            </footer>
        </h:body>
    </f:view>
</html>

